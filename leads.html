<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Leads â€“ Dhito Pro CRM</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="css/style.css">
</head>
<body class="dark">

<script src="js/auth.js"></script>
<script>protect()</script>

<h2>Database Konsumen</h2>

<input id="nama" placeholder="Nama Konsumen">
<input id="hp" placeholder="No HP">
<button onclick="simpan()">Simpan</button>

<ul id="list"></ul>

<script src="js/db.js"></script>
<script>
function simpan(){
  addLead({
addLead({
  nama: nama.value,
  hp: hp.value,
  status: "New",
  catatan: [],
  nextFollow: ""
});
  nama.value = hp.value = "";
  load();
}

function load(){
  getLeads(data=>{
    list.innerHTML = "";
    data.sort((a,b)=>{
      if(isToday(a.nextFollow)) return -1;
      if(isToday(b.nextFollow)) return 1;
      return b.id - a.id;
    });

    data.forEach(d=>{
      list.innerHTML += `
        <li style="border-left:4px solid ${statusColor(d.status)}">
          <b>${d.nama}</b><br>
          ${d.hp}<br>
          <small>Status: ${d.status}</small><br>
          ${d.nextFollow ? "FU: "+d.nextFollow : ""}
          <br>
          <a href="followup.html?id=${d.id}">Follow Up</a>
        </li>
      `;
    });
  });
}
setTimeout(load,500);
</script>

</body>
</html>
